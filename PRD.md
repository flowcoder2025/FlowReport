# ReportingOps(리포팅 운영) SaaS PRD — API Key 기반 연동 포함

> 목적: 고객사가 **주간/월간 리포트에 필요한 데이터를 스스로 입력·연동**하고, 시스템이 **자동 집계/검증/대시보드/리포트 출력**까지 수행하는 웹 서비스를 만든다.

---

## 1. 배경과 문제정의

### 1.1 배경
- 고객사 요청: 주간/월간 보고에 **SNS, 블로그, 온라인스토어** 지표 + 링크 + 인사이트(원인/개선/베스트프랙티스) + 차주/익월 계획을 **한 대시보드(또는 1pg 요약)**로 제공.

### 1.2 현재 문제
- 데이터가 채널/담당자/툴에 분산 → 매주 ‘자료 요청/정리/검증’에 시간 소모.
- 지표 정의가 불명확(DAU/매출 기준 등) → 보고서마다 숫자 분쟁/흔들림.
- 게시물 링크/원인/개선사항 등 정성 데이터는 자동수집이 어려워 누락 잦음.

### 1.3 해결 방향(제품)
- 고객사를 **사용자(tenant)**로 정의하고,
- 온보딩 절차(마법사)로 **연동(API Key / OAuth) 또는 파일업로드(CSV)**를 선택하게 하며,
- 주간/월간 템플릿에 맞춰 **필수 항목 입력을 강제**하고,
- 집계/증감/누락검증을 자동화하여 **대시보드 + 1pg 요약 + 상세 리포트(PDF/링크)**를 생성한다.

---

## 2. 목표/비목표

### 2.1 목표(Goals)
1) 고객사가 스스로 “필수지표”를 **연동 또는 업로드**하여 보고서를 완성
2) 주간/월간 필수 항목을 **누락 없이** 제출(시스템 검증)
3) 한 화면(대시보드)에서 **핵심 KPI + 추세 + 채널별 요약 + 인사이트/액션** 확인
4) 월간보고 **1pg 요약 대시보드** 출력 제공(PDF/링크)

### 2.2 비목표(Non-Goals) — 초기 MVP
- 모든 채널의 완전 자동화(연동은 1차 커넥터 중심, 나머지는 CSV/수동)
- 고급 예측/최적화 모델(추천/전략 자동생성)은 후순위

---

## 3. 사용자/권한

### 3.1 사용자 유형
- **고객사 Admin**: 워크스페이스 설정/연동/사용자 초대/권한 관리
- **마케터/운영자(Editor)**: 지표 확인, 링크/인사이트 입력, 리포트 제출
- **뷰어(Viewer)**: 조회만
- **내부 운영자(Ops, 선택)**: 멀티 고객 관리(대행사/내부 운영)

### 3.2 권한 모델(RBAC)
- Workspace 단위 권한
- 리포트(주간/월간) 단위: Draft/Submitted/Approved/Locked 상태에 따라 편집 제한

---

## 4. 핵심 기능(요구사항)

## 4.1 온보딩(마법사)

### 4.1.1 워크스페이스 생성
- 회사명/브랜드명, 타임존(KST 기본), 주간 기준(월~일/일~토 등), 월간 기준(1~말일)

### 4.1.2 데이터 소스 연결 방식 선택
- 옵션 A: **API Key/OAuth 연동**
- 옵션 B: **CSV/엑셀 업로드**
- 옵션 C: **수동 입력(최후 수단)**

### 4.1.3 지표 정의(SSOT: Single Source of Truth) 설정
- 온라인스토어
  - 매출 기준: 결제완료/배송완료/환불 포함 여부
  - 회원가입: 가입완료 정의(인증 포함 여부), 중복 제거 규칙
  - DAU/WAU: 로그인 사용자/방문자(세션) 기준 선택
- SNS
  - 업로드 범위: 피드/릴스/스토리/쇼츠 포함 여부
  - 조회/도달/상호작용 정의(채널별 용어 차이 매핑)
- 블로그
  - 방문자수/조회수/체류시간 기준(출처 툴)
  - 상위노출 키워드 기준(예: 10위 이내/1페이지/3위 이내)

> **확인 필요(고객사마다 상이)**: 어떤 소스를 ‘공식 숫자’로 사용할지(예: GA4 vs 스토어 어드민). 본 PRD는 SSOT로 확정하도록 설계.

---

## 4.2 커넥터(연동) — API Key 입력 → 데이터 수집

### 4.2.1 커넥터 공통 요구사항
- 고객사가 UI에서 **API Key(또는 토큰) 입력**
- 시스템은 유효성 검사(형식/권한/만료) 후 저장
- 데이터는 스케줄러가 주기 수집(예: 매일 03:00 KST) + 수동 동기화 버튼
- 에러 발생 시: 원인(권한 부족/만료/쿼터) + 해결 가이드 제공

### 4.2.2 지원 커넥터(모두 필수)

> 본 제품은 아래 커넥터를 **모두 제공**한다. 커넥터가 특정 지표를 제공하지 못하는 경우에도 대시보드의 필수 지표가 비지 않도록, 해당 지표는 **CSV 업로드 경로로 반드시 입력**되어야 한다.

#### A) 트래픽/활동(DAU/WAU) — GA4
- **Google Analytics 4 (GA4 Data API)**
  - 인증: 서비스 계정(JSON) + Property ID
  - 산출: 세션/사용자/DAU/WAU/전환(SSOT 정의에 따라)

#### B) SNS — Instagram/Facebook + YouTube
- **Meta (Instagram + Facebook Insights, Graph API)**
  - 인증: OAuth
  - 산출: 조회/도달/상호작용/팔로워, 게시물 리스트(링크 포함)
- **YouTube Analytics API**
  - 인증: OAuth
  - 산출: 조회/시청시간/구독자, 업로드 리스트(링크 포함)

#### C) 온라인스토어 — 스마트스토어 + 쿠팡
- **네이버 스마트스토어(네이버 커머스 API)**
  - 인증: OAuth2(Client Credentials)
  - 산출: 주문/매출/취소/환불/상품 성과/정산(제공 범위 내)
- **쿠팡 Wing OPEN API**
  - 인증: API Key
  - 산출: 주문/매출/취소/환불/상품 성과/정산(제공 범위 내)

#### D) 키워드/SEO
- **Google Search Console API**
  - 인증: OAuth
  - 산출: 쿼리(노출/클릭/CTR/평균순위)
- **네이버 키워드(서치어드바이저 기반)**
  - 방식: 커넥터 자동 수집이 불가한 경우가 있으므로, 본 제품은 **CSV 업로드 템플릿으로 반드시 수집**한다.

#### E) 블로그 지표
- 네이버 블로그/기타 블로그 통계는 제공 방식이 환경별로 달라질 수 있으므로, 본 제품은 **CSV 업로드 템플릿으로 반드시 수집**한다.

### 4.2.3 연동 방식(키 입력 포함) 표준화

- TikTok, X, 네이버 블로그/서치어드바이저, 스마트스토어/마켓플레이스(가능 시)

### 4.2.4 연동 키 입력 UX(단일 패턴)

> 용어: 본 서비스에서 ‘연동 키’는 **API Key / Client Secret / OAuth 토큰 / 서비스계정(JSON)** 등 *데이터 소스 연결에 필요한 자격증명*을 통칭한다.

- 소스별 입력 폼 자동 구성
  - API Key형: Key/Secret(필요 시), Vendor Account ID 등
  - OAuth형: “연동하기” 버튼(권한 스코프 안내) → 토큰 저장
  - 서비스계정형(GA4 등): JSON 업로드/붙여넣기 + Property ID 입력
- 공통 동작
  - 연결 테스트(권한/스코프/만료/쿼터 체크)
  - 성공 시: 마지막 동기화 시간, 동기화 범위(시작일~) 표시
  - 실패 시: 에러 코드 + 원인(권한/만료/쿼터/계정ID 불일치) + 해결 가이드
- 키 마스킹(****) / 교체 / 폐기

### 4.2.5 보안 요구사항(필수)

- Key/Token은 DB에 평문 저장 금지
- 암호화(예: KMS/Envelope) + 접근권한 최소화
- 감사 로그: 누가 언제 키를 등록/교체/삭제했는지 기록
- 토큰 범위 최소 스코프 권장 안내(least privilege)

---

## 4.3 CSV/엑셀 업로드(연동 불가 대비 MVP 핵심)

### 4.3.1 업로드 템플릿 제공
- 채널별 표준 템플릿(다운로드)
- 업로드 시 매핑 UI 제공(컬럼 자동 인식 + 수동 매핑)

### 4.3.2 검증
- 기간 누락/중복/형식 오류
- 필수 컬럼 누락 시 업로드 실패 + 안내

---

## 4.3.3 온라인스토어(스마트스토어/쿠팡/자사몰) 지표 스펙(필수)

> 원칙: 주간/월간 탭에서 ‘스토어 성과’는 **항상 동일한 필드 셋으로 출력**되어야 한다.
> - 커넥터가 제공하면 자동 수집
> - 커넥터가 제공하지 않으면 **CSV 업로드로 필수 입력**
> - 입력이 없으면 값은 비어있지 않으며, **N/A + 사유 코드**로 표시한다.

### A) 채널
- SMARTSTORE
- COUPANG
- SELFMALL

### B) 필수 지표(채널별, 기간별)
| 지표 | 코드 | 타입 | 정의(SSOT 연동) |
|---|---:|---|---|
| 매출(GMV) | sales_gmv | number | 기간 내 주문/결제금액 합계(매출 기준은 SSOT에서 확정) |
| 순매출(Net) | sales_net | number | 취소/환불 반영 순매출(산출 불가 시 N/A 처리) |
| 주문수 | orders_count | number | 주문 상태 기준(SSOT: 결제완료/주문확정/배송완료 중 1) |
| 판매수량 | units_sold | number | 판매된 총 수량 |
| 객단가(AOV) | aov | number | sales_net / orders_count (분모 0이면 0) |
| 취소건수 | cancels_count | number | 기간 내 취소 처리 주문 건수 |
| 환불건수 | refunds_count | number | 기간 내 환불 처리 건수 |
| 환불액 | refunds_amount | number | 기간 내 환불 처리 금액 |
| 반품건수 | returns_count | number | 기간 내 반품 처리 건수 |
| 취소율 | cancel_rate | number | cancels_count / (orders_count + cancels_count) (분모 0이면 0) |
| 반품율 | return_rate | number | returns_count / orders_count (분모 0이면 0) |
| 배송완료 주문수 | delivered_count | number | 배송완료 기준 주문 건수 |
| 정산예정액 | settlement_expected | number | 채널 정산 기준(SSOT에서 확정) |
| 수수료 합계 | fees_total | number | 판매/결제/기타 공제 합계(산출 불가 시 N/A 처리) |
| Top 상품 | top_products | list | 매출 기준 상위 N개(기본 N=10, 전체보기에서 전체 제공) |

### C) 트래픽/전환 지표(스토어 공통, 기간별)
- 트래픽/활동 지표는 **GA4를 단일 기준(SSOT)**으로 사용한다.
| 지표 | 코드 | 타입 | 정의 |
|---|---:|---|---|
| 세션 | sessions | number | GA4 세션 |
| 사용자 | users | number | GA4 사용자 |
| DAU | dau | number | GA4 일간 활성 |
| WAU | wau | number | GA4 주간 활성 |
| 전환율(주문) | conversion_rate | number | orders_count / sessions (분모 0이면 0) |

### D) N/A 사유 코드(필수 표기)
- NOT_PROVIDED_BY_CHANNEL: 채널/커넥터가 해당 지표를 제공하지 않음
- NOT_CONNECTED: 커넥터 미연결
- NOT_UPLOADED: CSV 미업로드
- NOT_APPLICABLE: 해당 채널에는 개념적으로 해당 지표가 없음

### E) SSOT(지표 정의) — 스토어 전용(필수 확정)
온보딩에서 아래 값을 **반드시 확정**해야 한다.
- 매출 기준: 결제완료 / 주문확정 / 배송완료 중 1
- Net 산출 규칙: 취소/환불 반영 방식
- 배송비/쿠폰/포인트 포함 여부
- 부분취소/부분환불 처리 규칙
- 정산/수수료 기준(공제 전/후, 포함 항목)

---

## 4.4 주간보고 기능(필수 요소 충족)

### 4.4.1 주간보고 데이터 모델(필수)
- SNS(채널별)
  - 업로드 횟수
  - 업로드 게시물 링크(리스트)
  - 조회수/도달/상호작용/팔로워수
  - 증감(전주 대비) + 원인/개선사항
  - 베스트 프랙티스(있을 경우)
- 온라인스토어(스마트스토어 + 쿠팡 + 자사몰 가능)
  - 매출(채널별/총합)
  - DAU/WAU(기본: GA4)
  - 회원가입수(증감)
  - 증감 원인/개선사항
- 차주 반영사항(체크리스트)

### 4.4.2 주간 대시보드 UI(한 페이지 내 ‘탭’ 구성)

> 정의: ‘한 대시보드’ = **단일 페이지**에서 탭으로 구분(스크롤 최소화). 예: [주간] / [월간] 상위 탭 + 각 탭 내부의 서브탭.

- 상위 탭: **주간 / 월간**
- 주간 서브탭(권장)
  1) Overview(요약)
     - KPI 카드: 매출/DAU/WAU/회원가입/총 도달/총 상호작용/팔로워 순증
     - 추세: 주간 매출/DAU/도달(라인)
     - 인사이트: 원인 Top3, 개선 Top3, 차주 반영사항
  2) SNS(채널별)
     - 채널별 요약표: 업로드수/조회/도달/상호작용/팔로워(전주 대비)
     - Top 게시물 3~5개 링크(기본) + 전체 리스트 접기/펼치기
  3) Store(스마트스토어/쿠팡/자사몰)
     - 채널별 매출/주문/회원가입(가능 범위) + 증감
     - DAU/WAU는 기본 GA4 기준 표시(SSOT에 따라 변경 가능)
  4) Notes(정성 입력)
     - 증감 원인/개선사항/베스트 프랙티스/차주 반영사항(편집 화면)

- 제출 전 자동 검증: 필수 항목 누락/링크 형식 오류/비교 기준값 부재

---

## 4.5 월간보고 기능(필수 요소 충족)

### 4.5.1 월간보고 섹션
① **전체 요약 대시보드 1pg**
- 핵심 KPI + 전월 대비 + 채널 믹스 요약

② 메인 키워드 쿼리
- 키워드 Top N(노출/클릭/CTR/순위/변동)

③ SNS
- 업로드 횟수/링크/채널별 조회/도달/상호작용/팔로워
- 증감 원인/개선/베스트 프랙티스

④ 블로그
- 전월 게시물 수, 조회수, 방문자수, 체류시간
- 상위노출 키워드

⑤ 온라인스토어(스마트스토어 + 쿠팡 + 자사몰)
- 채널별 필수 지표: 매출(GMV/Net), 주문수, 판매수량, AOV, 취소/환불/반품, 배송완료, 정산/수수료, Top 상품
- 트래픽/활동 필수 지표: 세션/사용자/DAU/WAU/전환율(주문) — GA4 기준
- 모든 지표는 **항상 출력**되며, 자동 수집 불가 시 CSV 업로드로 **필수 입력**되고, 미입력 시 N/A + 사유 코드로 표시됨
- 증감 원인 및 개선사항은 Notes 탭에서 **필수 입력**(원인 1개 이상, 개선 1개 이상)

⑥ 익월 반영사항 및 계획
- 목표/실행 항목/리스크

> 주의: 마켓(스마트스토어/쿠팡)에서 제공하는 ‘트래픽/방문’ 지표의 자동 수집 가능 범위는 계정/정책에 따라 달라질 수 있으므로, MVP는 GA4/CSV로 보완하는 설계를 기본값으로 둔다.


⑥ 익월 반영사항 및 계획
- 목표/실행 항목/리스크

> **확인 필요**: 제공 문구 중 ‘온라인스토어: 채널별 조회수, 도달, 상호작용, 팔로워수’는 일반적으로 SNS 지표와 혼재 가능성이 있어, 실제 고객사의 의도에 맞게 스키마를 확정해야 함.

### 4.5.2 월간 1pg 출력
- PDF Export
- 링크 공유(권한 기반)

---

## 4.6 대시보드 중심 운영(리포트 ‘제출/승인’ 없이)

> 방향: ‘보고서’를 따로 만들어 전달하기보다, **보고받는 당사자가 대시보드에 접속**해서 주간/월간 탭에서 확인한다.

### 4.6.1 핵심 요구사항
- **기간 선택(주간/월간)** + 전주/전월 비교
- 데이터가 늦게 확정/정정되는 상황을 대비하여 **스냅샷(버전) 보관**
- 외부 공유가 필요할 때만 **Export(선택)** 제공

### 4.6.2 스냅샷/버전(중요)
- 상태 모델(권장)
  - **Live**: 최신 동기화 기준으로 계속 변하는 값(환불/취소 반영 등)
  - **Snapshot**: 특정 시점에 고정된 ‘그때의 숫자’ 버전
  - **Locked**: 스냅샷을 잠금 처리(기준값으로 사용)
- 기능
  - 자동 스냅샷: 매주/매월 마감 시점(예: 월요일 09:00 KST, 익월 1일 10:00 KST)
  - 수동 스냅샷: 관리자만 생성 가능
  - 변경 로그: Live→Snapshot 차이(무엇이 왜 바뀌었는지) 기록/표시

### 4.6.3 정성 데이터(원인/개선/베스트프랙티스/계획) 처리
- ‘제출’ 대신 **Notes 탭에서 입력**
- 입력은 선택이되, 품질을 위해 다음 옵션 제공
  - 경고: “이번 주 원인/개선 미작성” 배지
  - 최소 가이드: 원인 1개/개선 1개/차주 반영 1개 추천
  - 근거 첨부(링크/캡처) 필드

### 4.6.4 공유/배포(필수)
- 링크 공유(권한 기반)
- Export: 월간 1pg **PDF** 생성
- Export: 월간 1pg **PNG** 생성

---

## 5. 데이터/도메인 모델(초안)

### 5.1 핵심 엔티티
- Workspace(고객사)
- ChannelConnection(연동 정보: provider, accountId, encryptedCredentials, status)
- MetricDefinition(SSOT 정의)
- MetricSnapshot(일/주/월 집계 스냅샷)
- SnapshotVersion(스냅샷 버전: live/snapshot/locked, createdAt, createdBy)
- ContentItem(게시물/영상/포스트: url, publishDate, channel)
- InsightNote(원인/개선/베스트프랙티스)
- ActionItem(차주/익월 반영사항)
- ChangeLog(Live↔Snapshot 차이 및 사유/근거)

### 5.2 증감 계산
- 주간: (이번주 - 전주) / 전주
- 월간: (이번달 - 전월) / 전월
- 분모 0 처리 룰: N/A 표시

---

## 6. 화면/IA(정보 구조)

1) 로그인
2) 워크스페이스 선택
3) 온보딩(연동/업로드/SSOT)
4) **대시보드(단일 페이지)**
- 상위 탭: **주간 / 월간**
- 주간 서브탭: Overview / SNS / Store / Notes
- 월간 서브탭: 1pg 요약 / 키워드 / SNS / 블로그 / Store / 계획 / Export(선택)
- 기간 선택 + Live/스냅샷 버전 선택(드롭다운)
5) 데이터 소스 관리
- 연동 키/토큰 관리
- 동기화 로그
6) 템플릿/정의 관리
- SSOT(지표 정의)
- 필수 항목(경고 기준) 설정
7) 스냅샷/버전 관리
- 자동 스냅샷 스케줄
- 수동 스냅샷 생성/잠금
- 변경 로그 확인

## 7. 비기능 요구사항(NFR)


- 보안: 비밀정보 암호화 저장, 권한 분리, 감사로그
- 안정성: 수집 실패 시 재시도, 부분 실패 허용(표시)
- 성능: 대시보드 3초 내 첫 로딩(캐시/사전 집계)
- 확장성: 멀티테넌트(고객사 데이터 격리)
- 컴플라이언스: 개인정보 최소 수집, 삭제 요청 처리

---

## 8. 성공 지표(Success Metrics)
- 온보딩 완료율(연동 또는 업로드 설정)
- 주간/월간 리포트 제출률(누락 0)
- 리포트 생성 소요시간(기존 대비 단축)
- 데이터 오류/분쟁 건수 감소(SSOT 도입 효과)

---

## 9. MVP 범위(권장)

### 9.1 반드시 포함
- 워크스페이스/권한
- SSOT 지표 정의
- 주간/월간 템플릿 + 필수항목 검증
- CSV 업로드 + 매핑
- 대시보드(한 화면) + PDF 출력(월간 1pg)
- 인사이트/액션 입력 폼

### 9.2 있으면 좋음
- 1~3개 커넥터(예: GA4 + Meta + YouTube) 우선
- 자동 동기화 스케줄러 + 동기화 로그

---

## 10. 범용 제품을 위한 기본 정책/설정(온보딩에서 선택 가능)

> ‘고객사에 확인’이 필요한 항목처럼 보였던 부분은, 실제로는 **고객사마다 달라지는 변수를 제품 설정값으로 흡수**하기 위한 목록이다. 범용 제품에서는 아래 **기본값(Default)**을 제공하고, 필요 시 온보딩/설정에서 변경 가능하게 한다.

### 10.1 한 대시보드 UX(필수 규격)
- 단일 페이지 구성
- 상위 탭: 주간 / 월간
- 서브탭: 요구사항에 정의된 모든 섹션을 탭으로 분리
- Overview 탭은 스크롤 최소화(요약 중심)
- 상세 리스트(게시물/상품/키워드)는 **기본 5개 노출 + ‘전체보기’ 패널에서 전체 제공**
- ‘전체보기’ 패널은 검색/정렬을 제공

### 10.2 온라인스토어 지표 범위(스마트스토어/쿠팡/자사몰)
- 기본값: 마켓(스마트스토어/쿠팡)은 **매출/주문/수량/취소·환불** 중심 자동화
- 트래픽/방문/DAU/WAU는 기본값으로 **GA4 기준(자사몰/랜딩 포함)**
- 마켓 내부 트래픽(노출/클릭 등)은 옵션: 지원 가능하면 커넥터/CSV로 추가

### 10.3 키워드 데이터 출처(우선순위 기본값)
- 기본값 우선순위
  1) **Google Search Console(연결되어 있으면)**
  2) **네이버 서치어드바이저(연결되어 있으면)**
  3) CSV 업로드(템플릿 제공)
  4) 수동 입력(예외)

### 10.4 SNS 채널 범위/지표 기준(필수)
- 고객사는 온보딩에서 운영 채널을 체크로 등록한다(등록된 채널은 모두 대시보드에 반영).
- 업로드 수는 **피드/릴스/스토리/쇼츠를 모두 포함**한다.

### 10.5 승인 프로세스 기본값
- 기본값: **제출/승인 워크플로우 없음**(대시보드 열람형)
- 대신 ‘기준값 고정’은 스냅샷/잠금으로 처리
  - Locked 스냅샷 생성 권한: Admin 기본

---

## 11. 내부 품질 기준(Engineering/QA용, 고객 노출 아님)

> ‘수용 기준’은 특정 고객사에 묻기 위한 문장이 아니라, **제품이 범용적으로 제대로 동작하는지 검증하는 내부 체크리스트**다. 
> 외부 공유용 PRD에서는 본 섹션을 숨기거나 별도 QA 문서로 분리할 수 있다.

- SSOT(지표 정의) 미완료 시, 해당 KPI 영역에 ‘정의 필요’ 상태가 명확히 표시된다.
- 주간/월간 탭에서 기간 선택 시 KPI/추세/요약표가 로드되며 전주/전월 대비가 계산된다(분모 0은 N/A).
- Live 데이터는 동기화로 갱신되고, Snapshot 생성 시 해당 기간 값이 고정된다.
- Locked 스냅샷은 Admin만 해제 가능하며 비교 기준으로 선택 가능하다.
- 연동 키 입력 후 연결 테스트가 가능하고, 실패 시 원인(권한/만료/쿼터/ID 불일치)이 표시된다.
- Export는 항상 제공되며, 월간 1pg는 PDF/PNG로 출력된다.

---

## 12. (참고) 템플릿 매핑 — 필수 포함요소 체크

### 주간(필수)
- SNS: 업로드 횟수, 게시물 링크, 채널별 조회/도달/상호작용/팔로워, 증감 원인/개선, 베스트 프랙티스(옵션)
- 온라인스토어: 매출, DAU, WAU, 회원가입(증감), 증감 원인/개선
- 차주 반영사항

### 월간(필수)
- 1pg 요약 대시보드
- 메인 키워드 쿼리
- SNS(상동)
- 블로그: 게시물 수/조회/방문/체류시간/상위노출 키워드
- 온라인스토어: (스토어 KPI) + 증감 원인/개선
- 익월 반영사항 및 계획

