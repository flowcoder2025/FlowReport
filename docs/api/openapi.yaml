openapi: 3.0.3
info:
  title: FlowReport API
  description: |
    FlowReport - ReportingOps SaaS 플랫폼 API 문서

    이 문서는 FlowReport의 주요 API 엔드포인트를 정의합니다.

    ## 인증
    모든 API는 세션 기반 인증이 필요합니다. NextAuth.js를 통해 인증됩니다.

    ## 권한
    - VIEWER: 조회 권한
    - EDITOR: 조회 및 수정 권한
    - ADMIN: 모든 권한 (생성, 수정, 삭제 포함)
  version: 1.0.0
  contact:
    name: FlowReport Team

servers:
  - url: /api
    description: API 기본 경로

tags:
  - name: ActionTemplates
    description: 액션 템플릿 관리 API - 지표 이상 시 자동 추천 액션 템플릿
  - name: Competitors
    description: 경쟁사 관리 API - 경쟁사 채널 정보 관리
  - name: Metrics
    description: 메트릭 조회 API - 워크스페이스 성과 지표 조회

paths:
  # ===========================================
  # ActionTemplate API
  # ===========================================
  /workspaces/{workspaceId}/action-templates:
    get:
      summary: 액션 템플릿 목록 조회
      description: |
        워크스페이스의 활성화된 액션 템플릿 목록을 조회합니다.
        triggerType과 department로 필터링할 수 있습니다.
      operationId: listActionTemplates
      tags:
        - ActionTemplates
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - name: triggerType
          in: query
          description: 트리거 타입으로 필터링
          required: false
          schema:
            $ref: '#/components/schemas/TriggerType'
        - name: department
          in: query
          description: 담당 부서로 필터링
          required: false
          schema:
            $ref: '#/components/schemas/Department'
      responses:
        '200':
          description: 액션 템플릿 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  templates:
                    type: array
                    items:
                      $ref: '#/components/schemas/ActionTemplate'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: 액션 템플릿 생성
      description: |
        새로운 액션 템플릿을 생성합니다.
        동일한 triggerType과 triggerLevel 조합은 워크스페이스 내에서 고유해야 합니다.
      operationId: createActionTemplate
      tags:
        - ActionTemplates
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateActionTemplateRequest'
      responses:
        '201':
          description: 액션 템플릿 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  template:
                    $ref: '#/components/schemas/ActionTemplate'
        '400':
          description: 필수 필드 누락
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Missing required fields: triggerType, title, description, department, departmentUrl"
        '409':
          description: 중복된 템플릿 존재
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Template with this triggerType and triggerLevel already exists"
        '500':
          $ref: '#/components/responses/InternalServerError'

  /workspaces/{workspaceId}/action-templates/{templateId}:
    get:
      summary: 액션 템플릿 상세 조회
      description: 특정 액션 템플릿의 상세 정보를 조회합니다.
      operationId: getActionTemplate
      tags:
        - ActionTemplates
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/TemplateId'
      responses:
        '200':
          description: 액션 템플릿 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  template:
                    $ref: '#/components/schemas/ActionTemplate'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      summary: 액션 템플릿 수정
      description: |
        기존 액션 템플릿을 수정합니다.
        기본 템플릿(isDefault=true)의 경우 triggerType, triggerLevel, department 필드는 수정할 수 없습니다.
      operationId: updateActionTemplate
      tags:
        - ActionTemplates
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/TemplateId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateActionTemplateRequest'
      responses:
        '200':
          description: 액션 템플릿 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  template:
                    $ref: '#/components/schemas/ActionTemplate'
        '403':
          description: 기본 템플릿의 보호된 필드 수정 시도
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Cannot modify protected fields of default templates"
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 액션 템플릿 삭제
      description: |
        액션 템플릿을 삭제합니다.
        기본 템플릿(isDefault=true)은 삭제할 수 없으며, 대신 비활성화(isActive=false)해야 합니다.
      operationId: deleteActionTemplate
      tags:
        - ActionTemplates
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/TemplateId'
      responses:
        '200':
          description: 액션 템플릿 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '403':
          description: 기본 템플릿 삭제 시도
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Cannot delete default templates. Deactivate instead."
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # ===========================================
  # Competitor API
  # ===========================================
  /workspaces/{workspaceId}/competitors:
    get:
      summary: 경쟁사 목록 조회
      description: 워크스페이스에 등록된 경쟁사 목록을 조회합니다.
      operationId: listCompetitors
      tags:
        - Competitors
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
      responses:
        '200':
          description: 경쟁사 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  competitors:
                    type: array
                    items:
                      $ref: '#/components/schemas/Competitor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: 경쟁사 추가
      description: |
        새로운 경쟁사를 등록합니다.
        동일한 platform과 channelId 조합은 워크스페이스 내에서 고유해야 합니다.
        ADMIN 권한이 필요합니다.
      operationId: createCompetitor
      tags:
        - Competitors
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCompetitorRequest'
      responses:
        '201':
          description: 경쟁사 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  competitor:
                    $ref: '#/components/schemas/Competitor'
        '400':
          description: 유효성 검사 실패 또는 중복된 경쟁사
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/ValidationError'
                  - $ref: '#/components/schemas/Error'
              examples:
                validation_error:
                  summary: 유효성 검사 실패
                  value:
                    error: "Validation failed"
                    details:
                      - path: ["name"]
                        message: "경쟁사 이름을 입력해주세요."
                duplicate_error:
                  summary: 중복된 경쟁사
                  value:
                    error: "이미 등록된 경쟁사입니다."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /workspaces/{workspaceId}/competitors/{competitorId}:
    get:
      summary: 경쟁사 상세 조회
      description: 특정 경쟁사의 상세 정보를 조회합니다.
      operationId: getCompetitor
      tags:
        - Competitors
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/CompetitorId'
      responses:
        '200':
          description: 경쟁사 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  competitor:
                    $ref: '#/components/schemas/Competitor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: 경쟁사를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "경쟁사를 찾을 수 없습니다."
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      summary: 경쟁사 정보 수정
      description: |
        경쟁사 정보를 수정합니다.
        platform이나 channelId 변경 시 중복 검사를 수행합니다.
        ADMIN 권한이 필요합니다.
      operationId: updateCompetitor
      tags:
        - Competitors
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/CompetitorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCompetitorRequest'
      responses:
        '200':
          description: 경쟁사 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  competitor:
                    $ref: '#/components/schemas/Competitor'
        '400':
          description: 유효성 검사 실패 또는 중복된 경쟁사
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/ValidationError'
                  - $ref: '#/components/schemas/Error'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: 경쟁사를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "경쟁사를 찾을 수 없습니다."
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 경쟁사 삭제
      description: |
        경쟁사를 삭제합니다.
        ADMIN 권한이 필요합니다.
      operationId: deleteCompetitor
      tags:
        - Competitors
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/CompetitorId'
      responses:
        '200':
          description: 경쟁사 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: 경쟁사를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "경쟁사를 찾을 수 없습니다."
        '500':
          $ref: '#/components/responses/InternalServerError'

  # ===========================================
  # Metrics API
  # ===========================================
  /workspaces/{workspaceId}/metrics:
    get:
      summary: 워크스페이스 메트릭 조회
      description: |
        워크스페이스의 종합 성과 지표를 조회합니다.

        ## 반환 데이터
        - **overview**: 전체 요약 지표 (매출, DAU, 팔로워, 참여 등)
        - **previous**: 이전 기간 지표 (비교용)
        - **sns**: SNS 채널별 지표 및 인기 콘텐츠
        - **store**: 커머스 채널별 지표 및 트래픽 데이터
        - **highlights**: 주요 변화 하이라이트 (상위 5개)
        - **channelDetails**: 채널별 상세 지표
      operationId: getMetrics
      tags:
        - Metrics
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - name: periodType
          in: query
          description: 기간 타입
          required: true
          schema:
            type: string
            enum:
              - WEEKLY
              - MONTHLY
        - name: periodStart
          in: query
          description: 기간 시작일 (YYYY-MM-DD 형식)
          required: true
          schema:
            type: string
            format: date
            example: "2026-02-03"
        - name: channels
          in: query
          description: 조회할 채널 목록 (콤마 구분)
          required: false
          schema:
            type: string
            example: "YOUTUBE,META_INSTAGRAM"
      responses:
        '200':
          description: 메트릭 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponse'
        '400':
          description: 잘못된 쿼리 파라미터
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  # ===========================================
  # Parameters
  # ===========================================
  parameters:
    WorkspaceId:
      name: workspaceId
      in: path
      description: 워크스페이스 ID
      required: true
      schema:
        type: string
        example: "clxxxxxxxxxxxxxxxxxx"

    TemplateId:
      name: templateId
      in: path
      description: 액션 템플릿 ID
      required: true
      schema:
        type: string
        example: "clxxxxxxxxxxxxxxxxxx"

    CompetitorId:
      name: competitorId
      in: path
      description: 경쟁사 ID
      required: true
      schema:
        type: string
        example: "clxxxxxxxxxxxxxxxxxx"

  # ===========================================
  # Responses
  # ===========================================
  responses:
    NotFound:
      description: 리소스를 찾을 수 없음
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Template not found"

    Unauthorized:
      description: 인증 필요
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Unauthorized"

    Forbidden:
      description: 권한 없음
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Forbidden"

    InternalServerError:
      description: 서버 내부 오류
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Internal server error"

  # ===========================================
  # Schemas
  # ===========================================
  schemas:
    # --- Enums ---
    TriggerType:
      type: string
      description: 액션 트리거 타입
      enum:
        - REVENUE_DECLINE_CRITICAL
        - REVENUE_DECLINE_WARNING
        - ENGAGEMENT_DECLINE_CRITICAL
        - ENGAGEMENT_DECLINE_WARNING
        - CONVERSION_LOW_CRITICAL
        - CONVERSION_LOW_WARNING
        - CHANNEL_METRIC_DECLINE

    AlertLevel:
      type: string
      description: 알림 레벨
      enum:
        - CRITICAL
        - WARNING
        - INFO

    ActionPriority:
      type: string
      description: 액션 우선순위
      enum:
        - HIGH
        - MEDIUM
        - LOW

    Department:
      type: string
      description: 담당 부서
      enum:
        - MARKETING
        - COMMERCE
        - OVERALL

    ChannelProvider:
      type: string
      description: 채널 제공자
      enum:
        - GA4
        - META_INSTAGRAM
        - META_FACEBOOK
        - YOUTUBE
        - SMARTSTORE
        - COUPANG
        - GOOGLE_SEARCH_CONSOLE
        - NAVER_BLOG
        - NAVER_KEYWORDS

    PeriodType:
      type: string
      description: 기간 타입
      enum:
        - DAILY
        - WEEKLY
        - MONTHLY

    # --- Error Schemas ---
    Error:
      type: object
      description: 에러 응답
      properties:
        error:
          type: string
          description: 에러 메시지
      required:
        - error

    ValidationError:
      type: object
      description: 유효성 검사 에러 응답
      properties:
        error:
          type: string
          example: "Validation failed"
        details:
          type: array
          items:
            type: object
            properties:
              path:
                type: array
                items:
                  type: string
              message:
                type: string

    # --- ActionTemplate Schemas ---
    ActionTemplate:
      type: object
      description: 액션 템플릿
      properties:
        id:
          type: string
          description: 템플릿 고유 ID
          example: "clxxxxxxxxxxxxxxxxxx"
        workspaceId:
          type: string
          description: 워크스페이스 ID
        triggerType:
          $ref: '#/components/schemas/TriggerType'
        triggerLevel:
          $ref: '#/components/schemas/AlertLevel'
        title:
          type: string
          description: 템플릿 제목
          example: "매출 급감 대응 체크리스트"
        description:
          type: string
          description: 템플릿 설명
          example: "매출이 전주 대비 20% 이상 감소했을 때 확인해야 할 사항"
        priority:
          $ref: '#/components/schemas/ActionPriority'
        department:
          $ref: '#/components/schemas/Department'
        departmentUrl:
          type: string
          description: 담당 부서 관련 URL
          example: "https://slack.com/channel/commerce"
        steps:
          type: array
          description: 액션 단계 목록
          items:
            type: string
          example:
            - "1. 쿠폰/프로모션 상태 확인"
            - "2. 상품 재고 확인"
            - "3. 경쟁사 프로모션 확인"
        isActive:
          type: boolean
          description: 활성화 여부
          example: true
        isDefault:
          type: boolean
          description: 시스템 기본 템플릿 여부
          example: false
        createdAt:
          type: string
          format: date-time
          description: 생성일시
        updatedAt:
          type: string
          format: date-time
          description: 수정일시

    CreateActionTemplateRequest:
      type: object
      description: 액션 템플릿 생성 요청
      required:
        - triggerType
        - title
        - description
        - department
        - departmentUrl
      properties:
        triggerType:
          $ref: '#/components/schemas/TriggerType'
        triggerLevel:
          $ref: '#/components/schemas/AlertLevel'
          default: WARNING
        title:
          type: string
          description: 템플릿 제목
          minLength: 1
        description:
          type: string
          description: 템플릿 설명
          minLength: 1
        priority:
          $ref: '#/components/schemas/ActionPriority'
          default: MEDIUM
        department:
          $ref: '#/components/schemas/Department'
        departmentUrl:
          type: string
          description: 담당 부서 관련 URL
        steps:
          type: array
          description: 액션 단계 목록
          items:
            type: string
          default: []

    UpdateActionTemplateRequest:
      type: object
      description: 액션 템플릿 수정 요청
      properties:
        title:
          type: string
          description: 템플릿 제목
        description:
          type: string
          description: 템플릿 설명
        priority:
          $ref: '#/components/schemas/ActionPriority'
        departmentUrl:
          type: string
          description: 담당 부서 관련 URL
        steps:
          type: array
          description: 액션 단계 목록
          items:
            type: string
        isActive:
          type: boolean
          description: 활성화 여부

    # --- Competitor Schemas ---
    Competitor:
      type: object
      description: 경쟁사
      properties:
        id:
          type: string
          description: 경쟁사 고유 ID
          example: "clxxxxxxxxxxxxxxxxxx"
        name:
          type: string
          description: 경쟁사 이름
          example: "경쟁사A"
        platform:
          $ref: '#/components/schemas/ChannelProvider'
        channelId:
          type: string
          description: 채널 ID (플랫폼별 고유 식별자)
          example: "UCxxxxxxxxxxxxxxxx"
        channelUrl:
          type: string
          format: uri
          nullable: true
          description: 채널 URL
          example: "https://www.youtube.com/channel/UCxxxxxxxxxxxxxxxx"
        followers:
          type: integer
          nullable: true
          description: 팔로워/구독자 수
          example: 150000
        engagementRate:
          type: number
          format: float
          nullable: true
          description: 참여율 (0-100)
          example: 5.2
        uploads:
          type: integer
          nullable: true
          description: 업로드 콘텐츠 수
          example: 320
        lastSyncAt:
          type: string
          format: date-time
          nullable: true
          description: 마지막 동기화 일시
        createdAt:
          type: string
          format: date-time
          description: 생성일시
        updatedAt:
          type: string
          format: date-time
          description: 수정일시

    CreateCompetitorRequest:
      type: object
      description: 경쟁사 생성 요청
      required:
        - name
        - platform
        - channelId
      properties:
        name:
          type: string
          description: 경쟁사 이름
          minLength: 1
        platform:
          $ref: '#/components/schemas/ChannelProvider'
        channelId:
          type: string
          description: 채널 ID
          minLength: 1
        channelUrl:
          type: string
          format: uri
          nullable: true
          description: 채널 URL
        followers:
          type: integer
          nullable: true
          minimum: 0
          description: 팔로워/구독자 수
        engagementRate:
          type: number
          format: float
          nullable: true
          minimum: 0
          maximum: 100
          description: 참여율 (0-100)
        uploads:
          type: integer
          nullable: true
          minimum: 0
          description: 업로드 콘텐츠 수

    UpdateCompetitorRequest:
      type: object
      description: 경쟁사 수정 요청
      properties:
        name:
          type: string
          description: 경쟁사 이름
          minLength: 1
        platform:
          $ref: '#/components/schemas/ChannelProvider'
        channelId:
          type: string
          description: 채널 ID
          minLength: 1
        channelUrl:
          type: string
          format: uri
          nullable: true
          description: 채널 URL
        followers:
          type: integer
          nullable: true
          minimum: 0
          description: 팔로워/구독자 수
        engagementRate:
          type: number
          format: float
          nullable: true
          minimum: 0
          maximum: 100
          description: 참여율 (0-100)
        uploads:
          type: integer
          nullable: true
          minimum: 0
          description: 업로드 콘텐츠 수

    # --- Metrics Schemas ---
    MetricsResponse:
      type: object
      description: 메트릭 응답
      properties:
        periodType:
          $ref: '#/components/schemas/PeriodType'
        periodStart:
          type: string
          format: date-time
          description: 기간 시작일시
        periodEnd:
          type: string
          format: date-time
          description: 기간 종료일시
        overview:
          $ref: '#/components/schemas/OverviewMetrics'
        previous:
          $ref: '#/components/schemas/OverviewMetrics'
        sns:
          type: object
          description: SNS 채널 지표
          properties:
            channels:
              type: array
              items:
                $ref: '#/components/schemas/ChannelMetrics'
            topPosts:
              type: array
              items:
                $ref: '#/components/schemas/TopPost'
        store:
          type: object
          description: 커머스 채널 지표
          properties:
            traffic:
              $ref: '#/components/schemas/TrafficData'
            channels:
              type: array
              items:
                $ref: '#/components/schemas/ChannelMetrics'
        highlights:
          type: array
          description: 주요 변화 하이라이트 (상위 5개)
          items:
            $ref: '#/components/schemas/Highlight'
        channelDetails:
          $ref: '#/components/schemas/ChannelDetails'

    OverviewMetrics:
      type: object
      description: 전체 요약 지표
      properties:
        totalRevenue:
          type: number
          nullable: true
          description: 총 매출
        dau:
          type: number
          nullable: true
          description: 일간 활성 사용자
        wau:
          type: number
          nullable: true
          description: 주간 활성 사용자
        mau:
          type: number
          nullable: true
          description: 월간 활성 사용자
        signups:
          type: number
          nullable: true
          description: 신규 가입자
        reach:
          type: number
          nullable: true
          description: 도달
        engagement:
          type: number
          nullable: true
          description: 참여
        followers:
          type: number
          nullable: true
          description: 팔로워
        uploads:
          type: number
          nullable: true
          description: 업로드 수

    ChannelMetrics:
      type: object
      description: 채널별 지표
      properties:
        channel:
          $ref: '#/components/schemas/ChannelProvider'
        channelName:
          type: string
          description: 채널 표시 이름
        data:
          type: object
          description: 현재 기간 지표 데이터
          additionalProperties:
            type: number
            nullable: true
        change:
          type: object
          description: 전 기간 대비 변화율 (%)
          additionalProperties:
            type: number
            nullable: true

    TopPost:
      type: object
      description: 인기 콘텐츠
      properties:
        id:
          type: string
          description: 콘텐츠 ID
        channel:
          $ref: '#/components/schemas/ChannelProvider'
        contentType:
          type: string
          description: 콘텐츠 유형
        title:
          type: string
          nullable: true
          description: 콘텐츠 제목
        url:
          type: string
          description: 콘텐츠 URL
        views:
          type: integer
          nullable: true
          description: 조회수
        engagement:
          type: integer
          nullable: true
          description: 참여 수

    TrafficData:
      type: object
      description: 트래픽 데이터 (GA4)
      properties:
        sessions:
          type: number
          nullable: true
          description: 세션 수
        users:
          type: number
          nullable: true
          description: 사용자 수
        dau:
          type: number
          nullable: true
          description: 일간 활성 사용자
        wau:
          type: number
          nullable: true
          description: 주간 활성 사용자
        conversionRate:
          type: number
          nullable: true
          description: 전환율
        previousSessions:
          type: number
          nullable: true
          description: 이전 기간 세션 수
        previousUsers:
          type: number
          nullable: true
          description: 이전 기간 사용자 수
        previousDau:
          type: number
          nullable: true
          description: 이전 기간 일간 활성 사용자
        previousWau:
          type: number
          nullable: true
          description: 이전 기간 주간 활성 사용자
        previousConversionRate:
          type: number
          nullable: true
          description: 이전 기간 전환율

    Highlight:
      type: object
      description: 주요 변화 하이라이트
      properties:
        channel:
          type: string
          description: 채널 이름
        metric:
          type: string
          description: 지표 이름 (한글)
        change:
          type: number
          description: 변화율 (%)
        direction:
          type: string
          enum:
            - up
            - down
          description: 변화 방향
        severity:
          type: string
          enum:
            - positive
            - negative
            - neutral
          description: 변화 성격

    ChannelDetails:
      type: object
      description: 채널별 상세 지표
      properties:
        YOUTUBE:
          $ref: '#/components/schemas/YouTubeMetrics'
        META_INSTAGRAM:
          $ref: '#/components/schemas/InstagramMetrics'
        SMARTSTORE:
          $ref: '#/components/schemas/StoreMetrics'
        COUPANG:
          $ref: '#/components/schemas/StoreMetrics'

    YouTubeMetrics:
      type: object
      description: YouTube 상세 지표
      properties:
        views:
          type: integer
          nullable: true
          description: 조회수
        estimatedMinutesWatched:
          type: number
          nullable: true
          description: 예상 시청 시간 (분)
        subscribers:
          type: integer
          nullable: true
          description: 구독자 수
        subscriberGained:
          type: integer
          nullable: true
          description: 신규 구독자
        engagement:
          type: integer
          nullable: true
          description: 총 참여 (좋아요+댓글+공유)
        likes:
          type: integer
          nullable: true
          description: 좋아요 수
        comments:
          type: integer
          nullable: true
          description: 댓글 수
        shares:
          type: integer
          nullable: true
          description: 공유 수
        change:
          type: object
          description: 변화율
          properties:
            views:
              type: number
              nullable: true
            estimatedMinutesWatched:
              type: number
              nullable: true
            subscribers:
              type: number
              nullable: true
            engagement:
              type: number
              nullable: true
        topVideos:
          type: array
          description: 인기 영상 (상위 3개)
          items:
            type: object
            properties:
              id:
                type: string
              title:
                type: string
                nullable: true
              url:
                type: string
              views:
                type: integer
                nullable: true
              engagement:
                type: integer
                nullable: true

    InstagramMetrics:
      type: object
      description: Instagram 상세 지표
      properties:
        reach:
          type: integer
          nullable: true
          description: 도달
        impressions:
          type: integer
          nullable: true
          description: 노출
        engagement:
          type: integer
          nullable: true
          description: 참여
        engagementRate:
          type: number
          nullable: true
          description: 참여율 (%)
        followers:
          type: integer
          nullable: true
          description: 팔로워 수
        change:
          type: object
          description: 변화율
          properties:
            reach:
              type: number
              nullable: true
            impressions:
              type: number
              nullable: true
            engagement:
              type: number
              nullable: true
            followers:
              type: number
              nullable: true

    StoreMetrics:
      type: object
      description: 커머스 스토어 상세 지표
      properties:
        revenue:
          type: number
          nullable: true
          description: 매출
        orders:
          type: integer
          nullable: true
          description: 주문 수
        conversionRate:
          type: number
          nullable: true
          description: 전환율 (%)
        avgOrderValue:
          type: number
          nullable: true
          description: 평균 주문 금액
        change:
          type: object
          description: 변화율
          properties:
            revenue:
              type: number
              nullable: true
            orders:
              type: number
              nullable: true
            conversionRate:
              type: number
              nullable: true
